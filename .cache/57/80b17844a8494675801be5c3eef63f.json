{"id":"ANm2","dependencies":[{"name":"D:\\med\\node_modules\\brain.js\\dist\\train-stream.js.map","includedInParent":true,"mtime":499162500000},{"name":"D:\\med\\package.json","includedInParent":true,"mtime":1553819528004},{"name":"D:\\med\\.babelrc","includedInParent":true,"mtime":1553726249193},{"name":"D:\\med\\node_modules\\brain.js\\package.json","includedInParent":true,"mtime":1553430479700},{"name":"stream","loc":{"line":9,"column":22},"parent":"D:\\med\\node_modules\\brain.js\\dist\\train-stream.js","resolved":"C:\\Users\\ДНС\\AppData\\Roaming\\npm\\node_modules\\parcel-bundler\\node_modules\\stream-browserify\\index.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var t=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),e=require(\"stream\");function i(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function r(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function o(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(a){function n(t){i(this,n);var e=r(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,{objectMode:!0}));if(!(t=t||{}).neuralNetwork)throw new Error(\"no neural network specified\");var o=t.neuralNetwork;e.neuralNetwork=o,e.dataFormatDetermined=!1,e.i=0,e.size=0,e.count=0,e.sum=0,e.floodCallback=t.floodCallback,e.doneTrainingCallback=t.doneTrainingCallback,o.updateTrainingOptions(t);var a=o.trainOpts;return e.iterations=a.iterations,e.errorThresh=a.errorThresh,e.log=a.log,e.logPeriod=a.logPeriod,e.callbackPeriod=a.callbackPeriod,e.callback=a.callback,e.on(\"finish\",e.finishStreamIteration.bind(e)),e}return o(n,e.Writable),t(n,[{key:\"endInputs\",value:function(){this.write(!1)}},{key:\"_write\",value:function(t,e,i){if(!t)return this.emit(\"finish\"),i();if(!this.dataFormatDetermined)return this.size++,this.neuralNetwork.addFormat(t),this.firstDatum=this.firstDatum||t,i();this.count++;var r=this.neuralNetwork.formatData(t);this.sum+=this.neuralNetwork.trainPattern(r[0],!0),i()}},{key:\"finishStreamIteration\",value:function(){if(this.dataFormatDetermined&&this.size!==this.count&&this.log(\"This iteration's data length was different from the first.\"),!this.dataFormatDetermined){var t=this.neuralNetwork.formatData(this.firstDatum);return this.neuralNetwork.verifyIsInitialized(t),this.dataFormatDetermined=!0,void(\"function\"==typeof this.floodCallback&&this.floodCallback())}var e=this.sum/this.size;if(this.log&&this.i%this.logPeriod==0&&this.log(\"iterations: \"+this.i+\", training error: \"+e),this.callback&&this.i%this.callbackPeriod==0&&this.callback({error:e,iterations:this.i}),this.sum=0,this.count=0,this.i++,this.i<this.iterations&&e>this.errorThresh){if(\"function\"==typeof this.floodCallback)return this.floodCallback()}else if(\"function\"==typeof this.doneTrainingCallback)return this.doneTrainingCallback({error:e,iterations:this.i})}}]),n}();exports.default=a;","map":{"mappings":[{"source":"../src/train-stream.js","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":317}},{"source":"../src/train-stream.js","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":319}},{"source":"../src/train-stream.js","name":null,"original":{"line":1,"column":0},"generated":{"line":1,"column":327}},{"source":"../src/train-stream.js","name":"TrainStream","original":{"line":9,"column":21},"generated":{"line":1,"column":913}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":2},"generated":{"line":1,"column":927}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":2},"generated":{"line":1,"column":936}},{"source":"../src/train-stream.js","name":"options","original":{"line":10,"column":14},"generated":{"line":1,"column":938}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":941}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":943}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":948}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":951}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":955}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":957}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":959}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":965}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":967}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":978}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":985}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":1000}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":1004}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":1009}},{"source":"../src/train-stream.js","name":null,"original":{"line":11,"column":10},"generated":{"line":1,"column":1014}},{"source":"../src/train-stream.js","name":"objectMode","original":{"line":12,"column":6},"generated":{"line":1,"column":1015}},{"source":"../src/train-stream.js","name":null,"original":{"line":12,"column":18},"generated":{"line":1,"column":1027}},{"source":"../src/train-stream.js","name":null,"original":{"line":18,"column":4},"generated":{"line":1,"column":1032}},{"source":"../src/train-stream.js","name":"options","original":{"line":15,"column":4},"generated":{"line":1,"column":1037}},{"source":"../src/train-stream.js","name":"options","original":{"line":15,"column":14},"generated":{"line":1,"column":1039}},{"source":"../src/train-stream.js","name":null,"original":{"line":15,"column":25},"generated":{"line":1,"column":1042}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":18,"column":17},"generated":{"line":1,"column":1046}},{"source":"../src/train-stream.js","name":null,"original":{"line":19,"column":6},"generated":{"line":1,"column":1060}},{"source":"../src/train-stream.js","name":null,"original":{"line":19,"column":12},"generated":{"line":1,"column":1066}},{"source":"../src/train-stream.js","name":"Error","original":{"line":19,"column":16},"generated":{"line":1,"column":1070}},{"source":"../src/train-stream.js","name":null,"original":{"line":19,"column":22},"generated":{"line":1,"column":1076}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":1107}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":22,"column":12},"generated":{"line":1,"column":1111}},{"source":"../src/train-stream.js","name":"options","original":{"line":22,"column":30},"generated":{"line":1,"column":1113}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":22,"column":12},"generated":{"line":1,"column":1115}},{"source":"../src/train-stream.js","name":null,"original":{"line":23,"column":4},"generated":{"line":1,"column":1129}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":23,"column":9},"generated":{"line":1,"column":1131}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":23,"column":25},"generated":{"line":1,"column":1145}},{"source":"../src/train-stream.js","name":null,"original":{"line":24,"column":4},"generated":{"line":1,"column":1147}},{"source":"../src/train-stream.js","name":"dataFormatDetermined","original":{"line":24,"column":9},"generated":{"line":1,"column":1149}},{"source":"../src/train-stream.js","name":null,"original":{"line":24,"column":32},"generated":{"line":1,"column":1171}},{"source":"../src/train-stream.js","name":null,"original":{"line":25,"column":4},"generated":{"line":1,"column":1173}},{"source":"../src/train-stream.js","name":"i","original":{"line":25,"column":9},"generated":{"line":1,"column":1175}},{"source":"../src/train-stream.js","name":null,"original":{"line":25,"column":13},"generated":{"line":1,"column":1177}},{"source":"../src/train-stream.js","name":null,"original":{"line":26,"column":4},"generated":{"line":1,"column":1179}},{"source":"../src/train-stream.js","name":"size","original":{"line":26,"column":9},"generated":{"line":1,"column":1181}},{"source":"../src/train-stream.js","name":null,"original":{"line":26,"column":16},"generated":{"line":1,"column":1186}},{"source":"../src/train-stream.js","name":null,"original":{"line":27,"column":4},"generated":{"line":1,"column":1188}},{"source":"../src/train-stream.js","name":"count","original":{"line":27,"column":9},"generated":{"line":1,"column":1190}},{"source":"../src/train-stream.js","name":null,"original":{"line":27,"column":17},"generated":{"line":1,"column":1196}},{"source":"../src/train-stream.js","name":null,"original":{"line":28,"column":4},"generated":{"line":1,"column":1198}},{"source":"../src/train-stream.js","name":"sum","original":{"line":28,"column":9},"generated":{"line":1,"column":1200}},{"source":"../src/train-stream.js","name":null,"original":{"line":28,"column":15},"generated":{"line":1,"column":1204}},{"source":"../src/train-stream.js","name":null,"original":{"line":29,"column":4},"generated":{"line":1,"column":1206}},{"source":"../src/train-stream.js","name":"floodCallback","original":{"line":29,"column":9},"generated":{"line":1,"column":1208}},{"source":"../src/train-stream.js","name":"options","original":{"line":29,"column":25},"generated":{"line":1,"column":1222}},{"source":"../src/train-stream.js","name":"floodCallback","original":{"line":29,"column":33},"generated":{"line":1,"column":1224}},{"source":"../src/train-stream.js","name":null,"original":{"line":30,"column":4},"generated":{"line":1,"column":1238}},{"source":"../src/train-stream.js","name":"doneTrainingCallback","original":{"line":30,"column":9},"generated":{"line":1,"column":1240}},{"source":"../src/train-stream.js","name":"options","original":{"line":30,"column":32},"generated":{"line":1,"column":1261}},{"source":"../src/train-stream.js","name":"doneTrainingCallback","original":{"line":30,"column":40},"generated":{"line":1,"column":1263}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":33,"column":4},"generated":{"line":1,"column":1284}},{"source":"../src/train-stream.js","name":"updateTrainingOptions","original":{"line":33,"column":18},"generated":{"line":1,"column":1286}},{"source":"../src/train-stream.js","name":"options","original":{"line":33,"column":40},"generated":{"line":1,"column":1308}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":1311}},{"source":"../src/train-stream.js","name":"trainOpts","original":{"line":34,"column":12},"generated":{"line":1,"column":1315}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":34,"column":26},"generated":{"line":1,"column":1317}},{"source":"../src/train-stream.js","name":"trainOpts","original":{"line":34,"column":12},"generated":{"line":1,"column":1319}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":1329}},{"source":"../src/train-stream.js","name":null,"original":{"line":35,"column":4},"generated":{"line":1,"column":1336}},{"source":"../src/train-stream.js","name":"iterations","original":{"line":35,"column":9},"generated":{"line":1,"column":1338}},{"source":"../src/train-stream.js","name":"trainOpts","original":{"line":35,"column":22},"generated":{"line":1,"column":1349}},{"source":"../src/train-stream.js","name":"iterations","original":{"line":35,"column":32},"generated":{"line":1,"column":1351}},{"source":"../src/train-stream.js","name":null,"original":{"line":36,"column":4},"generated":{"line":1,"column":1362}},{"source":"../src/train-stream.js","name":"errorThresh","original":{"line":36,"column":9},"generated":{"line":1,"column":1364}},{"source":"../src/train-stream.js","name":"trainOpts","original":{"line":36,"column":23},"generated":{"line":1,"column":1376}},{"source":"../src/train-stream.js","name":"errorThresh","original":{"line":36,"column":33},"generated":{"line":1,"column":1378}},{"source":"../src/train-stream.js","name":null,"original":{"line":37,"column":4},"generated":{"line":1,"column":1390}},{"source":"../src/train-stream.js","name":"log","original":{"line":37,"column":9},"generated":{"line":1,"column":1392}},{"source":"../src/train-stream.js","name":"trainOpts","original":{"line":37,"column":15},"generated":{"line":1,"column":1396}},{"source":"../src/train-stream.js","name":"log","original":{"line":37,"column":25},"generated":{"line":1,"column":1398}},{"source":"../src/train-stream.js","name":null,"original":{"line":38,"column":4},"generated":{"line":1,"column":1402}},{"source":"../src/train-stream.js","name":"logPeriod","original":{"line":38,"column":9},"generated":{"line":1,"column":1404}},{"source":"../src/train-stream.js","name":"trainOpts","original":{"line":38,"column":21},"generated":{"line":1,"column":1414}},{"source":"../src/train-stream.js","name":"logPeriod","original":{"line":38,"column":31},"generated":{"line":1,"column":1416}},{"source":"../src/train-stream.js","name":null,"original":{"line":39,"column":4},"generated":{"line":1,"column":1426}},{"source":"../src/train-stream.js","name":"callbackPeriod","original":{"line":39,"column":9},"generated":{"line":1,"column":1428}},{"source":"../src/train-stream.js","name":"trainOpts","original":{"line":39,"column":26},"generated":{"line":1,"column":1443}},{"source":"../src/train-stream.js","name":"callbackPeriod","original":{"line":39,"column":36},"generated":{"line":1,"column":1445}},{"source":"../src/train-stream.js","name":null,"original":{"line":40,"column":4},"generated":{"line":1,"column":1460}},{"source":"../src/train-stream.js","name":"callback","original":{"line":40,"column":9},"generated":{"line":1,"column":1462}},{"source":"../src/train-stream.js","name":"trainOpts","original":{"line":40,"column":20},"generated":{"line":1,"column":1471}},{"source":"../src/train-stream.js","name":"callback","original":{"line":40,"column":30},"generated":{"line":1,"column":1473}},{"source":"../src/train-stream.js","name":null,"original":{"line":42,"column":4},"generated":{"line":1,"column":1482}},{"source":"../src/train-stream.js","name":"on","original":{"line":42,"column":9},"generated":{"line":1,"column":1484}},{"source":"../src/train-stream.js","name":null,"original":{"line":42,"column":12},"generated":{"line":1,"column":1487}},{"source":"../src/train-stream.js","name":null,"original":{"line":42,"column":22},"generated":{"line":1,"column":1496}},{"source":"../src/train-stream.js","name":"finishStreamIteration","original":{"line":42,"column":27},"generated":{"line":1,"column":1498}},{"source":"../src/train-stream.js","name":"bind","original":{"line":42,"column":49},"generated":{"line":1,"column":1520}},{"source":"../src/train-stream.js","name":null,"original":{"line":42,"column":22},"generated":{"line":1,"column":1525}},{"source":"../src/train-stream.js","name":null,"original":{"line":10,"column":23},"generated":{"line":1,"column":1529}},{"source":"../src/train-stream.js","name":"Writable","original":{"line":9,"column":41},"generated":{"line":1,"column":1542}},{"source":"../src/train-stream.js","name":"Writable","original":{"line":9,"column":41},"generated":{"line":1,"column":1544}},{"source":"../src/train-stream.js","name":null,"original":{"line":46,"column":4},"generated":{"line":1,"column":1593}},{"source":"../src/train-stream.js","name":"write","original":{"line":46,"column":9},"generated":{"line":1,"column":1598}},{"source":"../src/train-stream.js","name":null,"original":{"line":46,"column":15},"generated":{"line":1,"column":1605}},{"source":"../src/train-stream.js","name":"chunk","original":{"line":57,"column":9},"generated":{"line":1,"column":1639}},{"source":"../src/train-stream.js","name":"enc","original":{"line":57,"column":16},"generated":{"line":1,"column":1641}},{"source":"../src/train-stream.js","name":"next","original":{"line":57,"column":21},"generated":{"line":1,"column":1643}},{"source":"../src/train-stream.js","name":null,"original":{"line":58,"column":4},"generated":{"line":1,"column":1646}},{"source":"../src/train-stream.js","name":"chunk","original":{"line":58,"column":9},"generated":{"line":1,"column":1650}},{"source":"../src/train-stream.js","name":null,"original":{"line":61,"column":6},"generated":{"line":1,"column":1652}},{"source":"../src/train-stream.js","name":null,"original":{"line":60,"column":6},"generated":{"line":1,"column":1659}},{"source":"../src/train-stream.js","name":"emit","original":{"line":60,"column":11},"generated":{"line":1,"column":1664}},{"source":"../src/train-stream.js","name":null,"original":{"line":60,"column":16},"generated":{"line":1,"column":1669}},{"source":"../src/train-stream.js","name":"next","original":{"line":61,"column":13},"generated":{"line":1,"column":1679}},{"source":"../src/train-stream.js","name":null,"original":{"line":64,"column":4},"generated":{"line":1,"column":1683}},{"source":"../src/train-stream.js","name":null,"original":{"line":64,"column":9},"generated":{"line":1,"column":1687}},{"source":"../src/train-stream.js","name":"dataFormatDetermined","original":{"line":64,"column":14},"generated":{"line":1,"column":1692}},{"source":"../src/train-stream.js","name":null,"original":{"line":68,"column":6},"generated":{"line":1,"column":1713}},{"source":"../src/train-stream.js","name":null,"original":{"line":65,"column":6},"generated":{"line":1,"column":1720}},{"source":"../src/train-stream.js","name":"size","original":{"line":65,"column":11},"generated":{"line":1,"column":1725}},{"source":"../src/train-stream.js","name":null,"original":{"line":66,"column":6},"generated":{"line":1,"column":1732}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":66,"column":11},"generated":{"line":1,"column":1737}},{"source":"../src/train-stream.js","name":"addFormat","original":{"line":66,"column":25},"generated":{"line":1,"column":1751}},{"source":"../src/train-stream.js","name":"chunk","original":{"line":66,"column":35},"generated":{"line":1,"column":1761}},{"source":"../src/train-stream.js","name":null,"original":{"line":67,"column":6},"generated":{"line":1,"column":1764}},{"source":"../src/train-stream.js","name":"firstDatum","original":{"line":67,"column":11},"generated":{"line":1,"column":1769}},{"source":"../src/train-stream.js","name":null,"original":{"line":67,"column":24},"generated":{"line":1,"column":1780}},{"source":"../src/train-stream.js","name":"firstDatum","original":{"line":67,"column":29},"generated":{"line":1,"column":1785}},{"source":"../src/train-stream.js","name":"chunk","original":{"line":67,"column":43},"generated":{"line":1,"column":1797}},{"source":"../src/train-stream.js","name":"next","original":{"line":68,"column":13},"generated":{"line":1,"column":1799}},{"source":"../src/train-stream.js","name":null,"original":{"line":71,"column":4},"generated":{"line":1,"column":1803}},{"source":"../src/train-stream.js","name":"count","original":{"line":71,"column":9},"generated":{"line":1,"column":1808}},{"source":"../src/train-stream.js","name":null,"original":{"line":73,"column":4},"generated":{"line":1,"column":1816}},{"source":"../src/train-stream.js","name":"data","original":{"line":73,"column":10},"generated":{"line":1,"column":1820}},{"source":"../src/train-stream.js","name":null,"original":{"line":73,"column":17},"generated":{"line":1,"column":1822}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":73,"column":22},"generated":{"line":1,"column":1827}},{"source":"../src/train-stream.js","name":"formatData","original":{"line":73,"column":36},"generated":{"line":1,"column":1841}},{"source":"../src/train-stream.js","name":"chunk","original":{"line":73,"column":47},"generated":{"line":1,"column":1852}},{"source":"../src/train-stream.js","name":null,"original":{"line":74,"column":4},"generated":{"line":1,"column":1855}},{"source":"../src/train-stream.js","name":"sum","original":{"line":74,"column":9},"generated":{"line":1,"column":1860}},{"source":"../src/train-stream.js","name":null,"original":{"line":74,"column":16},"generated":{"line":1,"column":1865}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":74,"column":21},"generated":{"line":1,"column":1870}},{"source":"../src/train-stream.js","name":"trainPattern","original":{"line":74,"column":35},"generated":{"line":1,"column":1884}},{"source":"../src/train-stream.js","name":"data","original":{"line":74,"column":48},"generated":{"line":1,"column":1897}},{"source":"../src/train-stream.js","name":null,"original":{"line":74,"column":53},"generated":{"line":1,"column":1899}},{"source":"../src/train-stream.js","name":null,"original":{"line":74,"column":57},"generated":{"line":1,"column":1903}},{"source":"../src/train-stream.js","name":"next","original":{"line":77,"column":4},"generated":{"line":1,"column":1906}},{"source":"../src/train-stream.js","name":null,"original":{"line":89,"column":4},"generated":{"line":1,"column":1958}},{"source":"../src/train-stream.js","name":null,"original":{"line":85,"column":8},"generated":{"line":1,"column":1961}},{"source":"../src/train-stream.js","name":"dataFormatDetermined","original":{"line":85,"column":13},"generated":{"line":1,"column":1966}},{"source":"../src/train-stream.js","name":null,"original":{"line":85,"column":37},"generated":{"line":1,"column":1988}},{"source":"../src/train-stream.js","name":"size","original":{"line":85,"column":42},"generated":{"line":1,"column":1993}},{"source":"../src/train-stream.js","name":null,"original":{"line":85,"column":51},"generated":{"line":1,"column":2000}},{"source":"../src/train-stream.js","name":"count","original":{"line":85,"column":56},"generated":{"line":1,"column":2005}},{"source":"../src/train-stream.js","name":null,"original":{"line":86,"column":6},"generated":{"line":1,"column":2012}},{"source":"../src/train-stream.js","name":"log","original":{"line":86,"column":11},"generated":{"line":1,"column":2017}},{"source":"../src/train-stream.js","name":null,"original":{"line":86,"column":15},"generated":{"line":1,"column":2021}},{"source":"../src/train-stream.js","name":null,"original":{"line":89,"column":9},"generated":{"line":1,"column":2084}},{"source":"../src/train-stream.js","name":"dataFormatDetermined","original":{"line":89,"column":14},"generated":{"line":1,"column":2089}},{"source":"../src/train-stream.js","name":null,"original":{"line":89,"column":36},"generated":{"line":1,"column":2110}},{"source":"../src/train-stream.js","name":null,"original":{"line":90,"column":6},"generated":{"line":1,"column":2111}},{"source":"../src/train-stream.js","name":"data","original":{"line":90,"column":12},"generated":{"line":1,"column":2115}},{"source":"../src/train-stream.js","name":null,"original":{"line":90,"column":19},"generated":{"line":1,"column":2117}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":90,"column":24},"generated":{"line":1,"column":2122}},{"source":"../src/train-stream.js","name":"formatData","original":{"line":90,"column":38},"generated":{"line":1,"column":2136}},{"source":"../src/train-stream.js","name":null,"original":{"line":90,"column":49},"generated":{"line":1,"column":2147}},{"source":"../src/train-stream.js","name":"firstDatum","original":{"line":90,"column":54},"generated":{"line":1,"column":2152}},{"source":"../src/train-stream.js","name":null,"original":{"line":97,"column":6},"generated":{"line":1,"column":2164}},{"source":"../src/train-stream.js","name":null,"original":{"line":91,"column":6},"generated":{"line":1,"column":2171}},{"source":"../src/train-stream.js","name":"neuralNetwork","original":{"line":91,"column":11},"generated":{"line":1,"column":2176}},{"source":"../src/train-stream.js","name":"verifyIsInitialized","original":{"line":91,"column":25},"generated":{"line":1,"column":2190}},{"source":"../src/train-stream.js","name":"data","original":{"line":91,"column":45},"generated":{"line":1,"column":2210}},{"source":"../src/train-stream.js","name":null,"original":{"line":92,"column":6},"generated":{"line":1,"column":2213}},{"source":"../src/train-stream.js","name":"dataFormatDetermined","original":{"line":92,"column":11},"generated":{"line":1,"column":2218}},{"source":"../src/train-stream.js","name":null,"original":{"line":92,"column":34},"generated":{"line":1,"column":2240}},{"source":"../src/train-stream.js","name":null,"original":{"line":94,"column":40},"generated":{"line":1,"column":2247}},{"source":"../src/train-stream.js","name":null,"original":{"line":94,"column":17},"generated":{"line":1,"column":2266}},{"source":"../src/train-stream.js","name":"floodCallback","original":{"line":94,"column":22},"generated":{"line":1,"column":2271}},{"source":"../src/train-stream.js","name":null,"original":{"line":95,"column":8},"generated":{"line":1,"column":2286}},{"source":"../src/train-stream.js","name":"floodCallback","original":{"line":95,"column":13},"generated":{"line":1,"column":2291}},{"source":"../src/train-stream.js","name":null,"original":{"line":100,"column":4},"generated":{"line":1,"column":2308}},{"source":"../src/train-stream.js","name":"error","original":{"line":100,"column":10},"generated":{"line":1,"column":2312}},{"source":"../src/train-stream.js","name":null,"original":{"line":100,"column":18},"generated":{"line":1,"column":2314}},{"source":"../src/train-stream.js","name":"sum","original":{"line":100,"column":23},"generated":{"line":1,"column":2319}},{"source":"../src/train-stream.js","name":null,"original":{"line":100,"column":29},"generated":{"line":1,"column":2323}},{"source":"../src/train-stream.js","name":"size","original":{"line":100,"column":34},"generated":{"line":1,"column":2328}},{"source":"../src/train-stream.js","name":null,"original":{"line":118,"column":4},"generated":{"line":1,"column":2333}},{"source":"../src/train-stream.js","name":null,"original":{"line":102,"column":8},"generated":{"line":1,"column":2336}},{"source":"../src/train-stream.js","name":"log","original":{"line":102,"column":13},"generated":{"line":1,"column":2341}},{"source":"../src/train-stream.js","name":null,"original":{"line":102,"column":21},"generated":{"line":1,"column":2346}},{"source":"../src/train-stream.js","name":"i","original":{"line":102,"column":26},"generated":{"line":1,"column":2351}},{"source":"../src/train-stream.js","name":null,"original":{"line":102,"column":30},"generated":{"line":1,"column":2353}},{"source":"../src/train-stream.js","name":"logPeriod","original":{"line":102,"column":35},"generated":{"line":1,"column":2358}},{"source":"../src/train-stream.js","name":null,"original":{"line":102,"column":49},"generated":{"line":1,"column":2369}},{"source":"../src/train-stream.js","name":null,"original":{"line":103,"column":6},"generated":{"line":1,"column":2372}},{"source":"../src/train-stream.js","name":"log","original":{"line":103,"column":11},"generated":{"line":1,"column":2377}},{"source":"../src/train-stream.js","name":null,"original":{"line":103,"column":6},"generated":{"line":1,"column":2381}},{"source":"../src/train-stream.js","name":null,"original":{"line":103,"column":31},"generated":{"line":1,"column":2396}},{"source":"../src/train-stream.js","name":"i","original":{"line":103,"column":36},"generated":{"line":1,"column":2401}},{"source":"../src/train-stream.js","name":null,"original":{"line":103,"column":6},"generated":{"line":1,"column":2403}},{"source":"../src/train-stream.js","name":"error","original":{"line":103,"column":59},"generated":{"line":1,"column":2424}},{"source":"../src/train-stream.js","name":null,"original":{"line":105,"column":8},"generated":{"line":1,"column":2427}},{"source":"../src/train-stream.js","name":"callback","original":{"line":105,"column":13},"generated":{"line":1,"column":2432}},{"source":"../src/train-stream.js","name":null,"original":{"line":105,"column":26},"generated":{"line":1,"column":2442}},{"source":"../src/train-stream.js","name":"i","original":{"line":105,"column":31},"generated":{"line":1,"column":2447}},{"source":"../src/train-stream.js","name":null,"original":{"line":105,"column":35},"generated":{"line":1,"column":2449}},{"source":"../src/train-stream.js","name":"callbackPeriod","original":{"line":105,"column":40},"generated":{"line":1,"column":2454}},{"source":"../src/train-stream.js","name":null,"original":{"line":105,"column":59},"generated":{"line":1,"column":2470}},{"source":"../src/train-stream.js","name":null,"original":{"line":106,"column":6},"generated":{"line":1,"column":2473}},{"source":"../src/train-stream.js","name":"callback","original":{"line":106,"column":11},"generated":{"line":1,"column":2478}},{"source":"../src/train-stream.js","name":null,"original":{"line":106,"column":20},"generated":{"line":1,"column":2487}},{"source":"../src/train-stream.js","name":"error","original":{"line":107,"column":8},"generated":{"line":1,"column":2488}},{"source":"../src/train-stream.js","name":"error","original":{"line":107,"column":15},"generated":{"line":1,"column":2494}},{"source":"../src/train-stream.js","name":"iterations","original":{"line":108,"column":8},"generated":{"line":1,"column":2496}},{"source":"../src/train-stream.js","name":null,"original":{"line":108,"column":20},"generated":{"line":1,"column":2507}},{"source":"../src/train-stream.js","name":"i","original":{"line":108,"column":25},"generated":{"line":1,"column":2512}},{"source":"../src/train-stream.js","name":null,"original":{"line":112,"column":4},"generated":{"line":1,"column":2516}},{"source":"../src/train-stream.js","name":"sum","original":{"line":112,"column":9},"generated":{"line":1,"column":2521}},{"source":"../src/train-stream.js","name":null,"original":{"line":112,"column":15},"generated":{"line":1,"column":2525}},{"source":"../src/train-stream.js","name":null,"original":{"line":113,"column":4},"generated":{"line":1,"column":2527}},{"source":"../src/train-stream.js","name":"count","original":{"line":113,"column":9},"generated":{"line":1,"column":2532}},{"source":"../src/train-stream.js","name":null,"original":{"line":113,"column":17},"generated":{"line":1,"column":2538}},{"source":"../src/train-stream.js","name":null,"original":{"line":115,"column":4},"generated":{"line":1,"column":2540}},{"source":"../src/train-stream.js","name":"i","original":{"line":115,"column":9},"generated":{"line":1,"column":2545}},{"source":"../src/train-stream.js","name":null,"original":{"line":118,"column":8},"generated":{"line":1,"column":2549}},{"source":"../src/train-stream.js","name":"i","original":{"line":118,"column":13},"generated":{"line":1,"column":2554}},{"source":"../src/train-stream.js","name":null,"original":{"line":118,"column":17},"generated":{"line":1,"column":2556}},{"source":"../src/train-stream.js","name":"iterations","original":{"line":118,"column":22},"generated":{"line":1,"column":2561}},{"source":"../src/train-stream.js","name":"error","original":{"line":118,"column":36},"generated":{"line":1,"column":2573}},{"source":"../src/train-stream.js","name":null,"original":{"line":118,"column":44},"generated":{"line":1,"column":2575}},{"source":"../src/train-stream.js","name":"errorThresh","original":{"line":118,"column":49},"generated":{"line":1,"column":2580}},{"source":"../src/train-stream.js","name":null,"original":{"line":119,"column":6},"generated":{"line":1,"column":2593}},{"source":"../src/train-stream.js","name":null,"original":{"line":119,"column":40},"generated":{"line":1,"column":2596}},{"source":"../src/train-stream.js","name":null,"original":{"line":119,"column":17},"generated":{"line":1,"column":2615}},{"source":"../src/train-stream.js","name":"floodCallback","original":{"line":119,"column":22},"generated":{"line":1,"column":2620}},{"source":"../src/train-stream.js","name":null,"original":{"line":120,"column":8},"generated":{"line":1,"column":2634}},{"source":"../src/train-stream.js","name":null,"original":{"line":120,"column":15},"generated":{"line":1,"column":2641}},{"source":"../src/train-stream.js","name":"floodCallback","original":{"line":120,"column":20},"generated":{"line":1,"column":2646}},{"source":"../src/train-stream.js","name":null,"original":{"line":124,"column":6},"generated":{"line":1,"column":2667}},{"source":"../src/train-stream.js","name":null,"original":{"line":124,"column":47},"generated":{"line":1,"column":2670}},{"source":"../src/train-stream.js","name":null,"original":{"line":124,"column":17},"generated":{"line":1,"column":2689}},{"source":"../src/train-stream.js","name":"doneTrainingCallback","original":{"line":124,"column":22},"generated":{"line":1,"column":2694}},{"source":"../src/train-stream.js","name":null,"original":{"line":125,"column":8},"generated":{"line":1,"column":2715}},{"source":"../src/train-stream.js","name":null,"original":{"line":125,"column":15},"generated":{"line":1,"column":2722}},{"source":"../src/train-stream.js","name":"doneTrainingCallback","original":{"line":125,"column":20},"generated":{"line":1,"column":2727}},{"source":"../src/train-stream.js","name":null,"original":{"line":125,"column":41},"generated":{"line":1,"column":2748}},{"source":"../src/train-stream.js","name":"error","original":{"line":126,"column":10},"generated":{"line":1,"column":2749}},{"source":"../src/train-stream.js","name":"error","original":{"line":126,"column":17},"generated":{"line":1,"column":2755}},{"source":"../src/train-stream.js","name":"iterations","original":{"line":127,"column":10},"generated":{"line":1,"column":2757}},{"source":"../src/train-stream.js","name":null,"original":{"line":127,"column":22},"generated":{"line":1,"column":2768}},{"source":"../src/train-stream.js","name":"i","original":{"line":127,"column":27},"generated":{"line":1,"column":2773}},{"source":"../src/train-stream.js","name":"TrainStream","original":{"line":9,"column":21},"generated":{"line":1,"column":2802}}],"sources":{"../src/train-stream.js":"import { Writable } from 'stream';\n\n/**\n *\n * @param opts\n * @returns {TrainStream}\n * @constructor\n */\nexport default class TrainStream extends Writable {\n  constructor(options) {\n    super({\n      objectMode: true\n    });\n\n    options = options || {};\n\n    // require the neuralNetwork\n    if (!options.neuralNetwork) {\n      throw new Error('no neural network specified');\n    }\n\n    const { neuralNetwork } = options;\n    this.neuralNetwork = neuralNetwork;\n    this.dataFormatDetermined = false;\n    this.i = 0; // keep track of internal iterations\n    this.size = 0;\n    this.count = 0;\n    this.sum = 0;\n    this.floodCallback = options.floodCallback;\n    this.doneTrainingCallback = options.doneTrainingCallback;\n\n    // inherit trainOpts settings from neuralNetwork\n    neuralNetwork.updateTrainingOptions(options);\n    const { trainOpts } = neuralNetwork;\n    this.iterations = trainOpts.iterations;\n    this.errorThresh = trainOpts.errorThresh;\n    this.log = trainOpts.log;\n    this.logPeriod = trainOpts.logPeriod;\n    this.callbackPeriod = trainOpts.callbackPeriod;\n    this.callback = trainOpts.callback;\n\n    this.on('finish', this.finishStreamIteration.bind(this));\n  }\n\n  endInputs() {\n    this.write(false);\n  }\n\n  /**\n   * _write expects data to be in the form of a datum. ie. {input: {a: 1 b: 0}, output: {z: 0}}\n   * @param chunk\n   * @param enc\n   * @param next\n   * @returns {*}\n   * @private\n   */\n  _write(chunk, enc, next) {\n    if (!chunk) {\n      // check for the end of one iteration of the stream\n      this.emit('finish');\n      return next();\n    }\n\n    if (!this.dataFormatDetermined) {\n      this.size++;\n      this.neuralNetwork.addFormat(chunk);\n      this.firstDatum = this.firstDatum || chunk;\n      return next();\n    }\n\n    this.count++;\n\n    const data = this.neuralNetwork.formatData(chunk);\n    this.sum += this.neuralNetwork.trainPattern(data[0], true);\n\n    // tell the Readable Stream that we are ready for more data\n    next();\n  }\n\n  /**\n   *\n   * @returns {*}\n   */\n  finishStreamIteration() {\n    if (this.dataFormatDetermined && this.size !== this.count) {\n      this.log('This iteration\\'s data length was different from the first.');\n    }\n\n    if (!this.dataFormatDetermined) {\n      const data = this.neuralNetwork.formatData(this.firstDatum);\n      this.neuralNetwork.verifyIsInitialized(data);\n      this.dataFormatDetermined = true;\n\n      if (typeof this.floodCallback === 'function') {\n        this.floodCallback();\n      }\n      return;\n    }\n\n    const error = this.sum / this.size;\n\n    if (this.log && (this.i % this.logPeriod === 0)) {\n      this.log(`iterations: ${ this.i}, training error: ${ error }`);\n    }\n    if (this.callback && (this.i % this.callbackPeriod === 0)) {\n      this.callback({\n        error: error,\n        iterations: this.i\n      });\n    }\n\n    this.sum = 0;\n    this.count = 0;\n    // update the iterations\n    this.i++;\n\n    // do a check here to see if we need the stream again\n    if (this.i < this.iterations && error > this.errorThresh) {\n      if (typeof this.floodCallback === 'function') {\n        return this.floodCallback();\n      }\n    } else {\n      // done training\n      if (typeof this.doneTrainingCallback === 'function') {\n        return this.doneTrainingCallback({\n          error: error,\n          iterations: this.i\n        });\n      }\n    }\n  }\n}\n"},"lineCount":null}},"hash":"5733644af6abc418e1476902fef9aef7","cacheData":{"env":{}}}